{
  "hash": "e402dd2d3531bf12c2dd7ce0c985234b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home_Exercise 1\"\nauthor: \"Qu JunJie\"\ndate: \"09 Sep 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  freeze: true\n  warning: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tidyverse, tmap, spNetwork, spatstat,ggplot2, leaflet, dplyr, lubridate)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#! eval:false\nacc <- read_csv(\"data/rawdata/thai_road_accident_2019_2022.csv\") %>%\n  mutate(Month_num = month(incident_datetime)) %>%\n  mutate(Month_fac = month(incident_datetime,\n                       label = TRUE,\n                       abbr = TRUE)) %>%\n  mutate(dayofweek = weekdays(incident_datetime))%>%\n  filter(!is.na(longitude) & !is.na(latitude)) %>%  # Remove rows with missing coordinates\n  st_as_sf(coords = c(\"longitude\", \"latitude\"),\n                       crs=4326) %>%\n  st_transform(crs = 32647)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbangkok_acc <- acc %>%\n  filter(province_en == \"Bangkok\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(bangkok_acc, \"data/rds/bangkok_acc_data.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbangkok_acc_data <- read_rds(\"data/rds/bangkok_acc_data.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nthai_one_map <- st_read(dsn = \"data/rawdata\",\n                        layer = \"hotosm_tha_roads_lines_shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `hotosm_tha_roads_lines_shp' from data source \n  `D:\\SMUJunJie\\ISSS626-GAA\\Take-Home_Ex\\Take-Home_Ex01\\data\\rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2792590 features and 14 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 97.34457 ymin: 5.643645 xmax: 105.6528 ymax: 20.47168\nCRS:           NA\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nadmin_boundaries <- st_read(dsn = \"data/rawdata\",\n                        layer = \"tha_admbnda_adm1_rtsd_20220121\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `D:\\SMUJunJie\\ISSS626-GAA\\Take-Home_Ex\\Take-Home_Ex01\\data\\rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbangkok_boundary <- admin_boundaries %>%\n  filter(ADM1_EN == \"Bangkok\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(thai_one_map) <- 4326\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbangkok_roads <- st_intersection(thai_one_map, bangkok_boundary)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(bangkok_roads, \"data/rds/bangkok_roads.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbangkok_roads_data <- read_rds(\"data/rds/bangkok_roads.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = bangkok_roads_data, color = \"gray\") + \n  geom_sf(data = bangkok_acc_data, aes(color = accident_type), alpha = 0.7) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](OldFile_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "OldFile_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}